#!/usr/bin/ksh -e
# script to combine X32 and X64 to Xany
for DIR in X32 X64; do
  cd ${DIR}
  rm -rf usr opt
  print restore ${DIR}/*.I
  restore -xqf *.I >/dev/null
  cd ..
done

[[ -e Xany ]] && mv Xany Xany.save.$(date "+%Y%m%d")
rm -rf Xany
mkdir Xany
# basis is to copy X64 and then copy 32-bit archive members
print Copy 64-bit version
cp -rp X64/* Xany/

# remove these bits from the Xany archive
rm -f Xany/lpp_name Xany/*.I
rm -rf Xany/usr/lpp
find ./Xany -name \*.la | xargs rm -f 

print Merge 32-bit libraries
for libs in X64/opt/lib/*.a; do
	cplib.ksh $libs
done

# just to make sure all .a files have been processed
#
print
print "all archives are:"
print date: `/usr/bin/date`
find Xany -mtime 1 -name \*.a -ls | /usr/bin/sort +11
